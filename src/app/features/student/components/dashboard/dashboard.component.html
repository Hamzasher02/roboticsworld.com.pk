<div class="mx-auto w-full max-w-[1300px] px-0 sm:px-4 sm:mb-10">
  <!-- Header -->
  <header class="px-0 sm:px-0">
    <h1 class="mb-6 px-0 text-2xl font-semibold text-gray-800 sm:px-0">Dashboard</h1>
  </header>

  <!-- Top Cards -->
  <section class="mb-10 flex w-full flex-col gap-4 px-0 sm:flex-row sm:flex-wrap sm:px-0">
    <!-- Enrolled Courses -->
    <div
      class="flex w-full items-center gap-4 rounded-lg border border-gray-200 bg-white p-4 sm:w-[calc(50%-8px)] lg:w-[calc(25%-12px)]">
      <div class="flex h-12 w-12 items-center justify-center bg-gray-100">
        <img src="assets/student/dashboard/PlayCircle.svg" alt="" />
      </div>
      <div class="flex flex-col">
        <div class="text-2xl font-semibold text-gray-800">{{enrolledCoursesCount}}</div>
        <p class="text-[12px] text-gray-500">Enrolled Courses</p>
      </div>
    </div>

    <!-- Active Courses -->
    <div
      class="flex w-full items-center gap-4 rounded-lg border border-gray-200 bg-white p-4 sm:w-[calc(50%-8px)] lg:w-[calc(25%-12px)]">
      <div class="flex h-12 w-12 items-center justify-center bg-gray-100">
        <img src="assets/student/dashboard/CheckSquareOffset.svg" alt="" />
      </div>
      <div class="flex flex-col">
        <div class="text-2xl font-semibold text-gray-800">{{activeCoursesCount}}</div>
        <p class="text-[12px] text-gray-500">Active Courses</p>
      </div>
    </div>

    <!-- Completed Courses -->
    <div
      class="flex w-full items-center gap-4 rounded-lg border border-gray-200 bg-white p-4 sm:w-[calc(50%-8px)] lg:w-[calc(25%-12px)]">
      <div class="flex h-12 w-12 items-center justify-center bg-gray-100">
        <img src="assets/student/dashboard/Trophy.svg" alt="" />
      </div>
      <div class="flex flex-col">
        <div class="text-2xl font-semibold text-gray-800">{{completedCoursesCount}}</div>
        <p class="text-[12px] text-gray-500">Completed Courses</p>
      </div>
    </div>

    <!-- Saved Courses -->
    <div
      class="flex w-full items-center gap-4 rounded-lg border border-gray-200 bg-white p-4 sm:w-[calc(50%-8px)] lg:w-[calc(25%-12px)]">
      <div class="flex h-12 w-12 items-center justify-center bg-gray-100">
        <img src="assets/student/dashboard/Heart.svg" alt="" />
      </div>
      <div class="flex flex-col">
        <div class="text-2xl font-semibold text-gray-800">{{wishlistCount}}</div>
        <p class="text-[12px] text-gray-500">Saved Courses</p>
      </div>
    </div>
  </section>

  <!-- Enrolled Courses -->
  <section class="mb-12 px-0 sm:px-0">
    <div class="mb-4 flex w-full flex-col gap-2 px-0 sm:flex-row sm:items-center sm:gap-4 sm:px-0">
      <h2 class="w-fit border-b-2 border-red-600 pb-1 text-base font-semibold text-red-600">
        Enrolled Courses
      </h2>

      <a routerLink="view-upcomming-sessions" class="text-base font-medium text-gray-500 hover:text-red-600">
        View Upcoming Sessions
      </a>

      <a *ngIf="enrolledCoursesData.length > 4" routerLink="/student/courses"
        class="text-sm font-semibold text-[#FF6A3D] hover:underline ml-auto">
        See all
      </a>
    </div>

    <!-- User is not enrolled message -->
    <div *ngIf="enrollments.length === 0"
      class="mb-6 rounded-lg bg-blue-50 p-4 border border-blue-200 flex items-center gap-3">
      <svg class="w-5 h-5 text-blue-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p class="text-sm text-blue-800">
        User is not enrolled in any course yet.
      </p>
    </div>

    <!-- Pending Message -->
    <div *ngIf="pendingEnrollments.length > 0 && !loading.enrollments"
      class="mb-6 rounded-lg bg-orange-50 p-4 border border-orange-200 flex items-center gap-3">
      <svg class="w-5 h-5 text-orange-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p class="text-sm text-orange-800">
        Waiting your request at pending until approved by admin. ({{pendingEnrollments.length}} pending)
      </p>
    </div>

    <!-- No Enrollments Message -->
    <div *ngIf="enrolledCoursesData.length === 0 && !loading.enrollments && pendingEnrollments.length === 0"
      class="rounded-lg border border-dashed border-gray-300 p-10 text-center mb-6">
      <div class="flex justify-center mb-4">
        <div class="rounded-full bg-orange-50 p-4">
          <svg class="h-12 w-12 text-orange-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
        </div>
      </div>
      <h3 class="text-lg font-semibold text-gray-900 mb-2">Start Your Learning Journey!</h3>
      <p class="text-gray-500 mb-4 max-w-md mx-auto">You haven't enrolled in any courses yet. Explore our wide range of
        courses and start learning today.</p>
      <a routerLink="/student/courses"
        class="inline-flex items-center gap-2 rounded-md bg-[#FF6A3D] px-6 py-2.5 text-sm font-semibold text-white transition hover:bg-orange-600">
        <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        Explore Courses
      </a>
    </div>

    <!-- Cards -->
    <div class="flex w-full flex-col gap-6 px-0 md:flex-row md:flex-wrap md:px-0">
      <!-- Card Loop -->
      <div *ngFor="let data of displayedEnrolledCourses"
        class="w-full overflow-hidden border border-gray-200 bg-white shadow-md md:w-[calc(50%-12px)] lg:w-[calc(33.333%-16px)] xl:w-[calc(25%-18px)]">
        <div class="relative h-44">
          <img [src]="data.course.thumbnail || 'assets/student/courseImage/CourseImages.svg'" alt=""
            class="h-full w-full object-cover" />

          <div class="absolute inset-0 flex items-center justify-center">
            <div class="flex justify-center items-center gap-2 h-9 bg-[#F5ECE1] px-4 py-2 shadow-sm backdrop-blur-sm">
              <img src="assets/student/dashboard/VideoPlayButtonIcone.svg" alt="" class="h-4 w-4" />
              <span class="text-sm font-medium text-gray-800">
                {{ data.enrollment.enrollmentType === 'Live Classes' ? 'Live Session' : 'Recorded Session' }}
              </span>
            </div>
          </div>
        </div>

        <div class="flex w-full flex-col">
          <div class="px-4 pt-4 pb-0">
            <h3 class="mb-1 text-[15px] font-semibold text-gray-800 line-clamp-1 truncate">{{data.course.title}}</h3>

            <p class="mb-3 line-clamp-2 text-xs text-gray-500">
              {{data.course.shortDescription || data.course.description}}
            </p>

            <div class="mb-3">
              <div class="mb-1 flex items-center justify-between text-xs text-gray-500">
                <span>Progress</span>
                <span>{{data.progress?.percentage || 0}}%</span>
              </div>
              <div class="h-1 w-full rounded-full bg-gray-200">
                <div class="h-1 rounded-full bg-orange-500" [style.width.%]="data.progress?.percentage || 0"></div>
              </div>
            </div>
          </div>

          <ng-container *ngIf="data.enrollment.enrollmentStatus === 'approved'; else pendingButton">
            <a [routerLink]="[data.enrollment.enrollmentType === 'Recorded Lectures' ? 'recorded-sessions' : 'live-sessions', data.course._id]"
              class="group flex h-10 w-full items-center justify-center gap-2 bg-orange-500 py-2 text-sm font-medium text-white hover:text-orange-600 transition-colors duration-200 hover:bg-orange-100">
              <span class="relative flex h-4 w-4 items-center justify-center">
                <img src="assets/student/dashboard/PlayButtonArrowhead.svg" alt=""
                  class="absolute h-3 w-3 opacity-100 transition-opacity duration-200 group-hover:opacity-0" />
                <img src="assets/student/courseImage/OrangePlayButton.svg" alt=""
                  class="absolute h-3 w-3 opacity-0 transition-opacity duration-200 group-hover:opacity-100" />
              </span>
              <span class="text-[12px]">Continue Learning</span>
            </a>
          </ng-container>
          <ng-template #pendingButton>
            <div
              class="flex h-10 w-full items-center justify-center gap-2 bg-gray-200 py-2 text-sm font-medium text-gray-500 cursor-not-allowed">
              <span class="text-[12px]">Pending Approval</span>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </section>

  <!-- Explore Courses -->
  <section class="px-0 sm:px-0">
    <div class="mb-4 flex w-full flex-col gap-2 px-0 sm:flex-row sm:items-center sm:justify-between sm:px-0">
      <h2 class="text-xl font-semibold text-gray-800">Explore Courses</h2>
      <a routerLink="/student/courses" class="text-sm font-semibold text-[#FF6A3D] hover:underline">See all</a>
    </div>

    <div class="flex w-full flex-col gap-4 px-0 sm:flex-row sm:flex-wrap sm:px-0">
      <div *ngFor="let course of exploreCourses"
        class="flex w-full flex-col overflow-hidden bg-white shadow-lg transition duration-300 hover:shadow-2xl sm:w-[calc(50%-8px)] md:w-[calc(33.333%-12px)] lg:w-[calc(20%-13px)]">
        <!-- Course Thumbnail -->
        <img [src]="course.courseThumbnail.secureUrl || 'assets/student/courseImage/CourseImages.svg'"
          alt="Course Thumbnail" class="h-28 w-full object-cover" />

        <div class="flex flex-1 flex-col justify-between">
          <!-- Course Title -->
          <div class="mt-2 border-b border-gray-200 pb-1">
            <h3 class="mx-1 text-[11px] font-medium leading-snug text-gray-900">
              {{ course.courseTitle }}
            </h3>
          </div>

          <!-- Rating, Price, Buttons (static rating) -->
          <div class="mx-2 mb-2 mt-2 flex items-center justify-between text-xs text-gray-600">
            <div class="flex items-center">
              <span class="mr-1 text-yellow-500">★</span>
              <span class="mr-1 font-medium">4.8</span>
              <span>(256)</span>
            </div>

            <div class="text-primary-orange text-gray-700 flex items-center gap-2">
              <span>${{ course.coursePrice }}</span>
              <span *ngIf="course.courseEnrollementType"
                class="text-[10px] uppercase font-bold px-2 py-0.5 rounded-full"
                [ngClass]="course.courseEnrollementType === 'live' ? 'bg-red-100 text-red-600' : 'bg-blue-100 text-blue-600'">
                {{ course.courseEnrollementType }}
              </span>
            </div>

            <div class="flex items-center gap-2">
              <button type="button" class="transition hover:opacity-80" (click)="addToCart(course._id)">
                <img src="assets/student/header/favIcone.svg" alt="" class="h-4 w-4" />
              </button>
              <button type="button" class="transition hover:opacity-80" (click)="addToCart(course._id)">
                <img src="assets/student/header/ShoppingCartSimple.svg" alt="" class="h-4 w-4" />
              </button>
            </div>
          </div>

          <!-- View Button -->
          <a [routerLink]="['/student/view-course', course._id]"
            class="mt-2 flex w-full items-center justify-center bg-orange-500 py-2 text-sm font-semibold text-white transition hover:opacity-90 hover:bg-orange-100 hover:text-orange-600">
            <span>View</span>
          </a>
        </div>
      </div>
    </div>
  </section>
</div>