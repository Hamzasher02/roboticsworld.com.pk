<div class="max-w-[1300px] mx-auto sm:px-6 lg:px-8   bg-white min-h-screen">

    <!-- Back -->
    <a [routerLink]="['/student']"
        class="flex items-center gap-1 text-sm font-medium text-gray-700 mb-6 hover:text-red-600 cursor-pointer">
        <svg class="h-4 w-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span>Back to Dashboard</span>
    </a>


    <!-- Loading State -->
    <div *ngIf="loading" class="flex justify-center py-10">
        <p class="text-gray-500">Loading sessions...</p>
    </div>

    <div *ngIf="!loading && error" class="p-4 mb-6 bg-red-50 text-red-600 rounded-lg">
        {{error}}
    </div>

    <!-- Notification -->
    <div *ngIf="!loading && nextLiveSession && nextLiveSession.course"
        class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 p-4 mb-6 bg-orange-50 border border-orange-200 rounded-lg">
        <div class="flex gap-3">
            <div class="w-8 h-8 bg-red-400 rounded-full flex items-center justify-center">
                <img src="assets/student/courseDemo/Group.svg" />
            </div>

            <div>
                <p class="text-sm font-semibold">Demo Requested</p>
                <p class="text-xs text-gray-600">
                    Your demo request for <b>{{nextLiveSession.course.courseTitle}}</b> is
                    <span class="font-bold">{{nextLiveSession.status | titlecase}}</span>.
                    <span *ngIf="nextLiveSession.instructor">Instructor:
                        <b>{{nextLiveSession.instructor.firstName}}</b>.</span>
                </p>
                <p class="text-xs text-gray-500">
                    {{nextLiveSession.preferredDate | date:'mediumDate'}}, {{nextLiveSession.preferredTime}}
                </p>
            </div>
        </div>

        <a *ngIf="nextLiveSession._id"
            [routerLink]="['/student/view-upcomming-sessions/view-session-detail', nextLiveSession._id]"
            class="px-3 py-1 text-xs bg-red-500 text-white rounded w-max inline-flex items-center justify-center">
            View Details
        </a>
    </div>

    <!-- Live Demo Card -->
    <div *ngIf="!loading && nextLiveSession && nextLiveSession.status === 'approved'"
        class="flex flex-col lg:flex-row bg-gray-100 rounded-xl p-6 mb-8 gap-6">

        <!-- Left -->
        <div class="flex-1 space-y-4">
            <div class="flex items-center gap-2">
                <img src="assets/student/courseDemo/VideoCamera.svg" class="w-6 h-6" />
                <h2 class="text-xl font-semibold">Next Session: {{nextLiveSession.course?.courseTitle}}</h2>
            </div>

            <div class="flex items-center gap-2 text-gray-700 text-sm">
                <img src="assets/student/courseDemo/Calendar.svg" class="w-5 h-5" />
                {{nextLiveSession.preferredDate | date:'fullDate'}} at {{nextLiveSession.preferredTime}}
            </div>

            <div class="flex items-center gap-2 text-yellow-600 font-bold text-sm">
                <img src="assets/student/courseDemo/Clock.svg" class="w-5 h-5" />
                {{nextLiveSession.status | titlecase}}
            </div>

            <a *ngIf="nextLiveSession.demoSessionLink" [href]="nextLiveSession.demoSessionLink" target="_blank"
                class="mt-4 flex items-center justify-center gap-2 px-8 py-3 bg-orange-500 rounded-lg text-white font-semibold hover:bg-orange-600 w-max">
                <img src="assets/student/forum/VideoCameraWhite.svg" class="w-5 h-5" />
                Join Session
            </a>
        </div>
    </div>

    <!-- Filters (Static for now as per requirement to not change design/only do dynamic) -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 pt-4 mb-8">
        <div>
            <label class="block text-xs font-medium text-gray-500 mb-1">Session Type</label>
            <select class="w-full border border-gray-200 rounded-md px-3 py-2 text-sm">
                <option>All Types</option>
            </select>
        </div>

        <div>
            <label class="block text-xs font-medium text-gray-500 mb-1">Category</label>
            <select class="w-full border border-gray-200 rounded-md px-3 py-2 text-sm">
                <option>All Categories</option>
            </select>
        </div>

        <div>
            <label class="block text-xs font-medium text-gray-500 mb-1">Course</label>
            <select class="w-full border border-gray-200 rounded-md px-3 py-2 text-sm">
                <option>All Courses</option>
            </select>
        </div>

        <div>
            <label class="block text-xs font-medium text-gray-500 mb-1">Age Group</label>
            <select class="w-full border border-gray-200 rounded-md px-3 py-2 text-sm">
                <option>All Age Group</option>
            </select>
        </div>

        <div>
            <label class="block text-xs font-medium text-gray-500 mb-1">Level</label>
            <select class="w-full border border-gray-200 rounded-md px-3 py-2 text-sm">
                <option>All Levels</option>
            </select>
        </div>
    </div>

    <!-- Sessions Table -->
    <div class="rounded-sm p-4 sm:p-6 overflow-hidden
        shadow-[-4px_0_10px_-4px_rgba(0,0,0,0.12),4px_0_6px_-4px_rgba(0,0,0,0.0),0_-6px_10px_-4px_rgba(0,0,0,0.08)]">

        <!-- Tabs -->
        <div class="flex flex-wrap gap-4 mb-6">
            <button (click)="setTab('upcoming')" class="pb-2 text-[16px] font-semibold transition-colors"
                [ngClass]="activeTab === 'upcoming' ? 'text-gray-900 border-b-2 border-red-500' : 'text-gray-400'">
                Upcoming Sessions
            </button>
            <button (click)="setTab('previous')" class="pb-2 text-[16px] font-semibold transition-colors"
                [ngClass]="activeTab === 'previous' ? 'text-gray-900 border-b-2 border-red-500' : 'text-gray-400'">
                Previous Sessions
            </button>
        </div>

        <!-- Table -->
        <div class="overflow-x-auto -mx-4 sm:mx-0">
            <table class="min-w-[800px] w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-6 py-3 text-left text-xs text-gray-500 uppercase tracking-wider">DATE & TIME</th>
                        <th class="px-6 py-3 text-left text-xs text-gray-500 uppercase tracking-wider">INSTRUCTOR</th>
                        <th class="px-6 py-3 text-left text-xs text-gray-500 uppercase tracking-wider">COURSE</th>
                        <th class="px-6 py-3 text-left text-xs text-gray-500 uppercase tracking-wider">STATUS</th>
                        <th class="px-6 py-3 text-right text-xs text-gray-500 uppercase tracking-wider">ACTIONS</th>
                    </tr>
                </thead>

                <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let session of displayedSessions" class="hover:bg-gray-50">
                        <!-- Date + Time -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-[13px] font-medium text-[#111827]">{{session.preferredDate |
                                date:'dd-MM-yyyy'}}</div>
                            <div class="text-[11px] text-[#9CA3AF]">{{session.preferredTime}}</div>
                        </td>

                        <!-- Instructor -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center gap-2">
                                <img [src]="session.instructor?.profilePicture?.secureUrl || 'assets/student/header/userAvatar.svg'"
                                    alt="User avatar" class="h-7 w-7 rounded-full object-cover" />
                                <span class="text-[13px] font-medium text-[#111827]">
                                    {{ session.instructor ? (session.instructor.firstName + ' ' +
                                    session.instructor.lastName) : 'Not Assigned' }}
                                </span>
                            </div>
                        </td>

                        <!-- Course -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="text-[13px] font-medium text-[#111827]">{{session.course?.courseTitle ||
                                'N/A'}}</span>
                        </td>

                        <!-- Status -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center rounded-full px-3 py-[3px] text-[12px] font-medium"
                                [ngClass]="{
                                    'bg-yellow-100 text-yellow-800': session.status === 'pending',
                                    'bg-green-100 text-green-800': session.status === 'approved',
                                    'bg-red-100 text-red-600': session.status === 'rejected' || session.status === 'cancelled',
                                    'bg-gray-100 text-gray-600': session.status === 'completed'
                                }">
                                {{session.status | titlecase}}
                            </span>
                        </td>

                        <!-- Action -->
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <a *ngIf="session._id"
                                [routerLink]="['/student/view-upcomming-sessions/view-session-detail', session._id]"
                                class="text-blue-600 hover:text-blue-900 font-medium cursor-pointer">
                                View
                            </a>
                        </td>
                    </tr>
                    <tr *ngIf="displayedSessions.length === 0">
                        <td colspan="5" class="px-6 py-10 text-center text-gray-500">
                            No sessions found for this category.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

</div>

<router-outlet></router-outlet>