<div class="w-full overflow-hidden bg-white">
  <div class="max-h-[85vh] overflow-y-auto">
    <div class="p-4 sm:p-6">
      <!-- Title -->
      <h1 class="text-[16px] sm:text-[18px] font-semibold text-gray-900">
        Set Course Pricing
      </h1>

      <!-- Form -->
      <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 sm:gap-x-8">
        <!-- Left -->
        <div class="space-y-3">
          <!-- Select Category -->
          <div class="relative">
            <select
              class="h-[42px] sm:h-[40px] w-full appearance-none rounded-[6px] border border-gray-200 bg-white px-3 pr-9 text-[12px] text-gray-700 focus:border-gray-300 focus:outline-none"
              [(ngModel)]="form.category"
              (ngModelChange)="onCategoryChange()"
              name="category"
            >
              <option value="" disabled selected>Select Category</option>
              <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
            </select>
            <span
              class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-gray-400"
              >▼</span
            >
          </div>

          <!-- Select Level -->
          <div class="relative">
            <select
              class="h-[42px] sm:h-[40px] w-full appearance-none rounded-[6px] border border-gray-200 bg-white px-3 pr-9 text-[12px] text-gray-700 focus:border-gray-300 focus:outline-none"
              [(ngModel)]="form.level"
              name="level"
            >
              <option value="" disabled selected>Select Level</option>
              <option *ngFor="let l of levels" [value]="l">{{ l }}</option>
            </select>
            <span
              class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-gray-400"
              >▼</span
            >
          </div>

          <!-- Age Group -->
          <div class="relative">
            <input
              class="h-[42px] sm:h-[40px] w-full rounded-[6px] border border-gray-200 bg-white px-3 text-[12px] text-gray-700 placeholder:text-gray-400 focus:border-gray-300 focus:outline-none"
              placeholder="Age Group"
              [(ngModel)]="form.ageGroup"
              name="ageGroup"
              list="ageGroups"
            />
            <datalist id="ageGroups">
              <option *ngFor="let a of ageGroups" [value]="a"></option>
            </datalist>
          </div>
        </div>

        <!-- Right -->
        <div class="space-y-3">
          <!-- Select Course -->
          <div class="relative">
            <select
              class="h-[42px] sm:h-[40px] w-full appearance-none rounded-[6px] border border-gray-200 bg-white px-3 pr-9 text-[12px] text-gray-700 focus:border-gray-300 focus:outline-none disabled:cursor-not-allowed disabled:bg-gray-50"
              [(ngModel)]="form.course"
              name="course"
              [disabled]="!form.category"
            >
              <option value="" disabled selected>Select Course</option>
              <option *ngFor="let cr of availableCourses" [value]="cr">
                {{ cr }}
              </option>
            </select>
            <span
              class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-gray-400"
              >▼</span
            >
          </div>

          <!-- Course Price -->
          <input
            class="h-[42px] sm:h-[40px] w-full rounded-[6px] border border-gray-200 bg-white px-3 text-[12px] text-gray-700 placeholder:text-gray-400 focus:border-gray-300 focus:outline-none"
            placeholder="Course Price"
            [(ngModel)]="form.price"
            name="price"
          />

          <!-- Discount -->
          <input
            class="h-[42px] sm:h-[40px] w-full rounded-[6px] border border-gray-200 bg-white px-3 text-[12px] text-gray-700 placeholder:text-gray-400 focus:border-gray-300 focus:outline-none"
            placeholder="Discount Code (optional)"
            [(ngModel)]="form.discountCode"
            name="discountCode"
          />
        </div>
      </div>

      <!-- ✅ Button (always after all fields) -->
      <div class="mt-4 flex ">
        <button
          type="button"
          (click)="updatePricing()"
          class="h-[40px] sm:h-[32px] w-full sm:w-auto rounded-[6px] bg-[#7B2B86] px-4 text-[11px] font-semibold text-white hover:opacity-95"
        >
          Update Pricing
        </button>
      </div>

      <!-- Section title -->
      <h2 class="mt-5 text-[12px] sm:text-[13px] font-semibold text-gray-900">
        Current Pricing Configurations
      </h2>

      <!-- ========================= -->
      <!-- ✅ MOBILE VIEW (Cards) -->
      <!-- ========================= -->
      <div class="mt-3 space-y-3 sm:hidden">
        <div
          *ngFor="let row of pagedConfigs; trackBy: trackById"
          class="rounded-[10px] border border-gray-200 bg-white p-3"
        >
          <!-- Top row: Category + Status -->
          <div class="flex items-start justify-between gap-3">
            <div class="min-w-0">
              <p class="text-[10px] text-gray-500">Category</p>
              <p class="text-[12px] font-semibold text-gray-800 truncate">
                {{ row.category }}
              </p>
            </div>

            <span
              class="shrink-0 rounded-full px-3 py-[2px] text-[10px] font-semibold"
              [ngClass]="
                row.status === 'Active'
                  ? 'bg-green-100 text-green-600'
                  : 'bg-red-100 text-red-600'
              "
            >
              {{ row.status }}
            </span>
          </div>

          <!-- Middle grid -->
          <div class="mt-3 grid grid-cols-2 gap-x-3 gap-y-2">
            <div class="min-w-0">
              <p class="text-[10px] text-gray-500">Course</p>
              <p class="text-[11px] text-gray-700 truncate">
                {{ row.courseName }}
              </p>
            </div>

            <div class="min-w-0 text-right">
              <p class="text-[10px] text-gray-500">Price</p>
              <p class="text-[11px] font-semibold text-gray-700">
                ${{ row.price }}
              </p>
            </div>

            <div class="min-w-0">
              <p class="text-[10px] text-gray-500">Level</p>
              <p class="text-[11px] text-gray-700 truncate">
                {{ row.level }}
              </p>
            </div>

            <div class="min-w-0 text-right">
              <p class="text-[10px] text-gray-500">Age</p>
              <p class="text-[11px] text-gray-700 truncate">
                {{ row.ageGroup }}
              </p>
            </div>
          </div>

          <!-- Action -->
          <div class="mt-3 flex justify-end">
            <button
              type="button"
              (click)="editRow(row)"
              class="rounded-[6px] border border-gray-200 px-3 py-2 text-[11px] font-semibold text-[#3b2c87] hover:bg-gray-50"
            >
              Edit
            </button>
          </div>
        </div>

        <!-- Mobile Pagination -->
        <div class="flex items-center justify-between pt-1">
          <button
            (click)="prevPage()"
            [disabled]="currentPage === 1"
            class="text-[10px] text-gray-600 disabled:opacity-50"
          >
            Previous
          </button>

          <div class="text-[10px] text-gray-500">
            {{ pageLabel }}
          </div>

          <button
            (click)="nextPage()"
            [disabled]="currentPage === totalPages"
            class="text-[10px] font-semibold text-[#7B2B86] disabled:opacity-50"
          >
            Next
          </button>
        </div>
      </div>

      <!-- ========================= -->
      <!-- ✅ DESKTOP/TABLET VIEW (Table) -->
      <!-- ========================= -->
      <div
        class="mt-3 hidden sm:block rounded-[10px] border border-gray-200 overflow-hidden"
      >
        <!-- Header -->
        <div
          class="grid grid-cols-12 border-b border-gray-200 bg-gray-50 px-3 py-2 text-[11px] font-semibold text-gray-700"
        >
          <div class="col-span-2">Category</div>
          <div class="col-span-2">Course</div>
          <div class="col-span-1 text-center">Level</div>
          <div class="col-span-1 text-center">Price</div>
          <div class="col-span-2 text-center">Age</div>
          <div class="col-span-2 text-center">Status</div>
          <div class="col-span-2 text-right">Action</div>
        </div>

        <!-- Body -->
        <div class="max-h-[200px] overflow-y-auto">
          <div
            *ngFor="let row of pagedConfigs; trackBy: trackById"
            class="grid grid-cols-12 items-center border-b border-gray-100 px-3 py-2 text-[11px]"
          >
            <div class="col-span-2 text-gray-600 truncate">
              {{ row.category }}
            </div>
            <div class="col-span-2 text-gray-600 truncate">
              {{ row.courseName }}
            </div>
            <div class="col-span-1 text-center whitespace-nowrap">
              {{ row.level }}
            </div>
            <div class="col-span-1 text-center whitespace-nowrap">
              ${{ row.price }}
            </div>
            <div class="col-span-2 text-center truncate">
              {{ row.ageGroup }}
            </div>

            <div class="col-span-2 flex justify-center">
              <span
                class="rounded-full px-3 py-[2px] text-[10px] font-semibold whitespace-nowrap"
                [ngClass]="
                  row.status === 'Active'
                    ? 'bg-green-100 text-green-600'
                    : 'bg-red-100 text-red-600'
                "
              >
                {{ row.status }}
              </span>
            </div>

            <div class="col-span-2 text-right">
              <button
                type="button"
                (click)="editRow(row)"
                class="text-[11px] font-semibold text-[#3b2c87] hover:underline"
              >
                Edit
              </button>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="flex items-center justify-between px-3 py-2">
          <button
            (click)="prevPage()"
            [disabled]="currentPage === 1"
            class="text-[10px] text-gray-600 disabled:opacity-50"
          >
            Previous
          </button>

          <div class="text-[10px] text-gray-500">
            {{ pageLabel }}
          </div>

          <button
            (click)="nextPage()"
            [disabled]="currentPage === totalPages"
            class="text-[10px] font-semibold text-[#7B2B86] disabled:opacity-50"
          >
            Next
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
