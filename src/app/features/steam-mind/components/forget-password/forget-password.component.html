<section
  class="relative min-h-screen w-full overflow-hidden
         bg-[radial-gradient(1100px_520px_at_22%_18%,rgba(236,200,230,0.55),transparent_62%),radial-gradient(1100px_650px_at_72%_78%,rgba(160,210,255,0.65),transparent_62%),linear-gradient(180deg,#EFE7F3_0%,#D7ECFF_100%)]">

  <!-- MAIN WRAPPER -->
  <div class="flex min-h-screen w-full items-center justify-center px-4 py-10">
    <div
      class="relative flex w-full max-w-[1180px] flex-col items-center justify-center lg:flex-row lg:items-center lg:justify-center">

      <!-- ================= CARD (ALWAYS CENTER) ================= -->
      <div class="z-10 flex w-full max-w-[400px] flex-col rounded-[12px] bg-white px-10 py-12
               shadow-[0_14px_34px_rgba(17,24,39,0.14)]">

        <!-- ===================== STEP 1: REQUEST ===================== -->
        <ng-container *ngIf="step === 'request'">
          <h2 class="text-center text-[22px] font-extrabold text-[#111827]">
            Forgot Your Password
          </h2>

          <p class="mx-auto mt-3 max-w-[380px] text-center text-[12px] leading-5 text-[#111827]/70">
            Please enter the email address or phone no youâ€™d like your
            password reset information sent to
          </p>

          <div class="mx-auto mt-6 flex w-full max-w-[360px] flex-col">
            <label class="mb-2 text-[12px] font-semibold text-[#111827]">
              Enter email or phone no*
            </label>

            <input [(ngModel)]="requestValue" type="text" placeholder="Registered email or phone no" class="h-[44px] w-full rounded-[6px]
                     border border-[#C084FC]
                     px-4 text-[13px] text-[#111827]
                     outline-none placeholder:text-[#9CA3AF]
                     focus:border-[#A855F7]" />

            <button (click)="openOtp()" [disabled]="loading" class="mt-5 flex h-[42px] w-full items-center justify-center
                     rounded-[999px] bg-[#7A2E8D]
                     text-[13px] font-semibold text-white
                     shadow-[0_10px_18px_rgba(122,46,141,0.25)]
                     hover:opacity-95 disabled:opacity-70 disabled:cursor-not-allowed">
              {{ loading ? 'Requesting...' : 'Request Reset Link' }}
            </button>

            <a routerLink="/steam-mind/login"
              class="mt-4 text-center text-[12px] font-medium text-[#1D4ED8] hover:underline">
              Back To Login
            </a>
          </div>
        </ng-container>

        <!-- ===================== STEP 2: OTP ===================== -->
        <ng-container *ngIf="step === 'otp'">
          <h2 class="text-center text-[20px] font-semibold text-[#111827] sm:text-[22px]">
            Enter OTP
          </h2>

          <p class="mx-auto mt-2 max-w-[300px] text-center text-[11px] leading-4 text-[#111827]/80">
            We have sent a OTP to your Phone no
          </p>

          <div class="mt-6 flex w-full flex-col gap-2">
            <label class="text-[12px] font-semibold text-[#111827]">Enter 4-digit OTP</label>

            <div class="flex w-full items-center justify-center gap-4">
              <input #otpInput inputmode="numeric" maxlength="1"
                class="h-[42px] w-[42px] rounded-[6px] border border-[#C084FC] text-center text-[16px] font-semibold text-[#111827] outline-none focus:border-[#A855F7]"
                [value]="otp[0]" (input)="onOtpInput(0, $event)" (keydown)="onOtpKeydown(0, $event)" />

              <input #otpInput inputmode="numeric" maxlength="1"
                class="h-[42px] w-[42px] rounded-[6px] border border-[#C084FC] text-center text-[16px] font-semibold text-[#111827] outline-none focus:border-[#A855F7]"
                [value]="otp[1]" (input)="onOtpInput(1, $event)" (keydown)="onOtpKeydown(1, $event)" />

              <input #otpInput inputmode="numeric" maxlength="1"
                class="h-[42px] w-[42px] rounded-[6px] border border-[#C084FC] text-center text-[16px] font-semibold text-[#111827] outline-none focus:border-[#A855F7]"
                [value]="otp[2]" (input)="onOtpInput(2, $event)" (keydown)="onOtpKeydown(2, $event)" />

              <input #otpInput inputmode="numeric" maxlength="1"
                class="h-[42px] w-[42px] rounded-[6px] border border-[#C084FC] text-center text-[16px] font-semibold text-[#111827] outline-none focus:border-[#A855F7]"
                [value]="otp[3]" (input)="onOtpInput(3, $event)" (keydown)="onOtpKeydown(3, $event)" />
            </div>
          </div>

          <button (click)="verifyOtp()" [disabled]="loading"
            class="mt-5 flex h-[44px] w-full items-center justify-center rounded-[999px]
                   bg-[#7A2E8D] text-[13px] font-semibold text-white hover:opacity-95 disabled:opacity-70 disabled:cursor-not-allowed">
            {{ loading ? 'Verifying...' : 'Verify' }}
          </button>

          <div class="mt-4 flex w-full items-center justify-center gap-2 text-[12px] text-[#6B7280]">
            <span>Didn't receive code?</span>
            <button type="button" (click)="resendOtp()" class="font-semibold text-[#7A2E8D] hover:underline">
              Resend OTP
            </button>
          </div>
        </ng-container>

        <!-- ===================== STEP 3: RESET ===================== -->
        <ng-container *ngIf="step === 'reset'">
          <h2 class="text-center text-[20px] font-semibold text-[#111827] sm:text-[22px]">
            Enter your new password
          </h2>

          <p class="mx-auto mt-2 max-w-[320px] text-center text-[11px] leading-4 text-[#111827]/70">
            Your new password must be different to previous passwords.
          </p>

          <div class="mt-6 flex w-full flex-col gap-4">
            <div class="flex w-full flex-col gap-2">
              <label class="text-[12px] font-semibold text-[#111827]">Enter new password</label>
              <input [(ngModel)]="resetForm.password" type="password" class="h-[44px] w-full rounded-[6px] border border-[#C084FC] px-4 text-[13px] text-[#111827]
                       outline-none placeholder:text-[#9CA3AF] focus:border-[#A855F7]" />
            </div>

            <div class="flex w-full flex-col gap-2">
              <label class="text-[12px] font-semibold text-[#111827]">Confirm new password</label>
              <input [(ngModel)]="resetForm.confirmPassword" type="password" class="h-[44px] w-full rounded-[6px] border border-[#C084FC] px-4 text-[13px] text-[#111827]
                       outline-none placeholder:text-[#9CA3AF] focus:border-[#A855F7]" />
            </div>
          </div>

          <button (click)="resetPassword()" [disabled]="loading"
            class="mt-6 flex h-[44px] w-full items-center justify-center rounded-[999px]
                   bg-[#7A2E8D] text-[13px] font-semibold text-white hover:opacity-95 disabled:opacity-70 disabled:cursor-not-allowed">
            {{ loading ? 'Resetting...' : 'Reset Password' }}
          </button>
        </ng-container>
      </div>

      <!-- ================= MOBILE/TABLET IMAGE (BELOW CARD) ================= -->
      <div class="mt-8 flex w-full items-center justify-center lg:hidden">
        <img src="assets/steam-mind/auth/pngegg-(4)-1.svg" alt="Forgot Password Illustration" class="h-[230px] w-auto object-contain
                 drop-shadow-[0_22px_34px_rgba(17,24,39,0.18)]" draggable="false" />
      </div>

      <!-- ================= DESKTOP IMAGE (RIGHT SIDE) ================= -->
      <div class="pointer-events-none absolute left-[65%] top-1/2 hidden translate-y-[-25%] lg:flex">
        <img src="assets/steam-mind/auth/pngegg-(4)-1.svg" alt="Forgot Password Illustration" class="h-[450px] w-auto object-contain
                 drop-shadow-[0_22px_34px_rgba(17,24,39,0.18)]" draggable="false" />
      </div>
    </div>
  </div>
</section>